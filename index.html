<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dopelee Prezzed by S‚Ñ¢ | Your Smart Legacy Portal</title>

  <style>
    :root {
      --black: #000;
      --white: #fff;
      --text-muted: #afafaf;
      --gold: #D4AF37;
    }

    body {
      margin: 0;
      background: #000;
      color: var(--white);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* ===============================
        LUXURY GRADIENT HEADER BAR
       =============================== */
    .gradient-header {
      width: 100%;
      padding: 70px 20px 90px;
      text-align: center;
      background: linear-gradient(
        90deg,
        #5aa0a9,
        #8beab3,
        #f7f59c,
        #f56cea,
        #8c6cf7
      );
    }

    .gradient-header img {
      height: 150px;
      margin-bottom: 15px;
    }

    .gradient-title {
      font-size: 3rem;
      font-weight: 900;
      color: #000;
      margin: 10px 0;
    }

    .gradient-sub {
      font-size: 1.3rem;
      color: #000;
      opacity: 0.9;
      font-style: italic;
      margin-top: 8px;
    }

    /* ===============================
        MAIN CONTENT WRAPPER
       =============================== */
    .container {
      width: 100%;
      max-width: 900px;
      margin: 40px auto;
      padding: 0 20px;
      flex: 1;
    }

    #content {
      min-height: 300px;
    }

    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-muted);
      font-size: 1.2rem;
    }

    /* FOOTER */
    .footer {
      text-align: center;
      padding: 40px 20px;
      background: #000;
      border-top: 1px solid rgba(255,255,255,0.08);
      margin-top: 80px;
    }

    .footer a {
      color: var(--gold);
      text-decoration: none;
      margin: 0 8px;
    }

    .footer p {
      margin: 6px 0;
      color: var(--text-muted);
    }
  </style>
</head>

<body>

  <!-- ===============================
       LUXURY GRADIENT HEADER
     =============================== -->
  <header class="gradient-header">
    <img src="logo.png" alt="Dopelee Prezzed by S‚Ñ¢">
    <div class="gradient-title">DOPELEE PREZZED BY S‚Ñ¢</div>
    <div class="gradient-sub">Luxury keepsakes. Timelessly crafted.</div>
  </header>

  <!-- ===============================
       MAIN PORTAL CONTENT
     =============================== -->
  <div class="container">
    <div id="content">
      <div class="loading">Loading your portal‚Ä¶</div>
    </div>
  </div>

  <!-- ===============================
        SMART PORTAL JAVASCRIPT ENGINE
     =============================== -->
<script>

//////////////////////////////////////////////////////////////
//  CONFIGURATION
//////////////////////////////////////////////////////////////

const SHEET_ID = "1vhv6D32H97WQHgvtC6Jh_6CTb4u1txKk98mjKDCKW_A";
const API_KEY = "AIzaSyBeteoBZZlHtydPRd-CqBQ1E0edQPXxtEE";
const SMARTFORM_URL = "https://dopeleeprezzed-oss.github.io/dopelee-form/";

const SHEETS = {
  KEEPSAKES: "KEEPSAKES",
  VIP: "VIP_PROJECTS",
  PHOTOBOOKS: "PHOTOBOOKS",
  PARTNERSHIPS: "PARTNERSHIPS"
};

let currentEmail = "";
let allOrders = [];


//////////////////////////////////////////////////////////////
//  PAGE LOAD ‚Äì URL CHECK
//////////////////////////////////////////////////////////////

document.addEventListener("DOMContentLoaded", () => {
  const params = new URLSearchParams(window.location.search);
  const email = params.get("email");
  const orderId = params.get("order");

  if (email) {
    currentEmail = email;
    loadOrdersByEmail(email);
  } else if (orderId) {
    loadOrderByID(orderId);
  } else {
    document.getElementById("content").innerHTML = `
      <div class="loading">Enter your email to view your orders.</div>
    `;
  }
});


//////////////////////////////////////////////////////////////
//  API FETCH
//////////////////////////////////////////////////////////////

async function fetchSheet(sheetName) {
  const url =
    `https://sheets.googleapis.com/v4/spreadsheets/${SHEET_ID}/values/${sheetName}?key=${API_KEY}`;

  const res = await fetch(url);
  const json = await res.json();
  return json.values || [];
}


//////////////////////////////////////////////////////////////
//  LOAD ORDERS BY EMAIL
//////////////////////////////////////////////////////////////

async function loadOrdersByEmail(email) {
  document.getElementById("content").innerHTML =
    `<div class="loading">Searching orders for ${email}‚Ä¶</div>`;

  const [keeps, vip, books, partners] = await Promise.all([
    fetchSheet(SHEETS.KEEPSAKES),
    fetchSheet(SHEETS.VIP),
    fetchSheet(SHEETS.PHOTOBOOKS),
    fetchSheet(SHEETS.PARTNERSHIPS)
  ]);

  allOrders = [
    ...parseKeepsakes(keeps, email),
    ...parseVIP(vip, email),
    ...parseBooks(books, email),
    ...parsePartners(partners, email)
  ];

  if (allOrders.length === 0) {
    document.getElementById("content").innerHTML =
      `<div class="loading">No orders found for ${email}.</div>`;
  } else {
    displayOrderList();
  }
}


//////////////////////////////////////////////////////////////
//  FIND ORDER BY ID
//////////////////////////////////////////////////////////////

async function loadOrderByID(orderId) {
  document.getElementById("content").innerHTML =
    `<div class="loading">Loading order ${orderId}‚Ä¶</div>`;

  const [keeps, vip, books, partners] = await Promise.all([
    fetchSheet(SHEETS.KEEPSAKES),
    fetchSheet(SHEETS.VIP),
    fetchSheet(SHEETS.PHOTOBOOKS),
    fetchSheet(SHEETS.PARTNERSHIPS)
  ]);

  let order =
    findOrder(keeps, orderId, "KEEPSAKE") ||
    findOrder(vip, orderId, "VIP") ||
    findOrder(books, orderId, "PHOTOBOOK") ||
    findOrder(partners, orderId, "PARTNERSHIP");

  if (!order) {
    document.getElementById("content").innerHTML =
      `<div class="loading">Order ${orderId} not found.</div>`;
  } else {
    displayOrderDetails(order);
  }
}


//////////////////////////////////////////////////////////////
//  PARSERS
//////////////////////////////////////////////////////////////

function parseKeepsakes(data, email) {
  if (!data || data.length < 2) return [];

  const out = [];
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    if (!row[2]) continue;
    if (row[2].toLowerCase() !== email.toLowerCase()) continue;

    out.push({
      type: "KEEPSAKE",
      id: row[0],
      status: row[6],
      date: row[7] || row[8],
      row
    });
  }
  return out;
}

function parseVIP(data, email) {
  if (!data || data.length < 2) return [];

  const out = [];
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    if (!row[2]) continue;
    if (row[2].toLowerCase() !== email.toLowerCase()) continue;

    out.push({
      type: "VIP",
      id: row[0],
      status: row[6],
      date: row[7],
      row
    });
  }
  return out;
}

function parseBooks(data, email) {
  if (!data || data.length < 2) return [];

  const out = [];
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    if (!row[2]) continue;
    if (row[2].toLowerCase() !== email.toLowerCase()) continue;

    out.push({
      type: "PHOTOBOOK",
      id: row[0],
      status: row[6],
      date: row[7] || row[8],
      row
    });
  }
  return out;
}

function parsePartners(data, email) {
  if (!data || data.length < 2) return [];

  const out = [];
  for (let i = 1; i < data.length; i++) {
    const row = data[i];
    if (!row[4]) continue;
    if (row[4].toLowerCase() !== email.toLowerCase()) continue;

    out.push({
      type: "PARTNERSHIP",
      id: row[0],
      status: row[10],
      date: row[1],
      row
    });
  }
  return out;
}


//////////////////////////////////////////////////////////////
//  FIND ORDER BY ID IN RAW SHEET
//////////////////////////////////////////////////////////////

function findOrder(data, orderId, type) {
  if (!data || data.length < 2) return null;
  for (let i = 1; i < data.length; i++) {
    if (data[i][0] === orderId) {
      return {
        type,
        id: orderId,
        status: data[i][6] || data[i][10] || "",
        row: data[i]
      };
    }
  }
  return null;
}


//////////////////////////////////////////////////////////////
//  DISPLAY ORDER LIST
//////////////////////////////////////////////////////////////

function displayOrderList() {
  let html = `
    <h2>Your Orders for ${currentEmail}</h2>
    <p>Select an order to view details.</p>
  `;

  allOrders.forEach(order => {
    html += `
      <div style="padding:15px; border-bottom:1px solid #333; cursor:pointer;"
           onclick='displayOrderDetails(${JSON.stringify(order).replace(/"/g, "&quot;")})'>
        <strong>${order.type}</strong> ‚Äî ${order.id}<br>
        <span style="color:var(--text-muted);">${order.status}</span>
      </div>
    `;
  });

  document.getElementById("content").innerHTML = html;
}


//////////////////////////////////////////////////////////////
//  DISPLAY ORDER DETAILS
//////////////////////////////////////////////////////////////

function displayOrderDetails(order) {
  const row = order.row;

  let html = `
    <button onclick="displayOrderList()" 
            style="margin-bottom:20px; padding:10px 20px;">
      ‚Üê Back
    </button>

    <h2>${order.type} ‚Äî ${order.id}</h2>
    <p>Status: ${order.status}</p>
  `;

  document.getElementById("content").innerHTML = html;
}

</script>

<!-- ===============================
       FOOTER
     =============================== -->
<footer class="footer">
  <p>üñ§ DOPELEE PREZZED BY S‚Ñ¢</p>
  <p>Luxury keepsakes. Timelessly crafted.</p>

  <p>
    <a href="https://www.dopeleeprezzedbys.com" target="_blank">Visit Website</a> ‚Ä¢
    <a href="mailto:info@dopeleeprezzedbysllc.com">Contact Us</a>
  </p>

  <p style="font-size:0.85rem; opacity:0.8;">
    ¬© 2025 Dopelee Prezzed by S, LLC. All rights reserved.
  </p>
</footer>

</body>
</html>


