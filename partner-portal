<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Legacy Lounge™ Partner Portal</title>

<style>
  body {
    margin: 0;
    font-family: 'Inter', Arial, sans-serif;
    background: #0b0c0f;
    color: #fff;
  }

  /* HEADER */
  .header {
    background: linear-gradient(90deg,#0a95a8,#3461fa,#fd26fd,#d3fb1b);
    padding: 30px 20px;
    text-align: center;
    border-bottom: 3px solid #d3fb1b;
  }
  .header h1 {
    margin: 0;
    font-size: 28px;
    font-weight: 800;
    text-shadow: 0 2px 6px rgba(0,0,0,0.4);
  }
  .header p {
    margin: 6px 0 0;
    font-size: 14px;
    opacity: .9;
  }

  /* MAIN WRAPPER */
  .container {
    max-width: 900px;
    margin: 30px auto;
    padding: 20px;
  }

  /* DASHBOARD CARDS */
  .card {
    background: #121319;
    border: 1px solid #1f2024;
    border-radius: 14px;
    padding: 22px;
    margin-bottom: 25px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.55);
  }
  .card h2 {
    margin-top: 0;
    font-size: 20px;
    letter-spacing: .5px;
    border-left: 4px solid #d3fb1b;
    padding-left: 10px;
  }
  .card p, .card span {
    color: #cfcfcf;
    font-size: 15px;
    line-height: 1.6;
  }

  .stats-row {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
  }
  .stat-box {
    flex: 1;
    min-width: 200px;
    background: #1b1c22;
    border-radius: 12px;
    padding: 18px;
    border: 1px solid #292a30;
    text-align: center;
  }
  .stat-box h3 {
    margin: 0;
    font-size: 16px;
    color: #d3fb1b;
  }
  .stat-box p {
    margin: 8px 0 0;
    font-size: 22px;
    font-weight: 700;
  }

  /* QR CODE */
  .qr-box img {
    width: 150px;
    height: 150px;
    margin-top: 12px;
    border-radius: 10px;
  }

  /* CONTACT BUTTON */
  .contact-btn {
    display: block;
    width: 100%;
    background: #d3fb1b;
    color: #000;
    text-align: center;
    padding: 16px;
    border-radius: 10px;
    font-weight: 700;
    font-size: 18px;
    text-decoration: none;
    margin-top: 15px;
    transition: .3s;
  }
  .contact-btn:hover {
    background: #c3eb18;
  }
</style>
</head>

<body>

<div class="header">
  <h1>Legacy Lounge™ Partner Portal</h1>
  <p>Your Display • Your Earnings • Your Impact</p>
</div>

<div class="container">

  <!-- PARTNER INFO CARD -->
  <div class="card" id="partnerInfo">
    <h2>Partner Information</h2>
    <p><strong>Business:</strong> <span id="businessName"></span></p>
    <p><strong>Contact Person:</strong> <span id="contactPerson"></span></p>
    <p><strong>Email:</strong> <span id="contactEmail"></span></p>
    <p><strong>Status:</strong> <span id="status"></span></p>
  </div>

  <!-- INSTALLATION -->
  <div class="card">
    <h2>Installation Status</h2>
    <p><strong>Scheduled:</strong> <span id="installScheduled"></span></p>
    <p><strong>Completed:</strong> <span id="installCompleted"></span></p>
    <p><strong>Activated:</strong> <span id="activated"></span></p>
  </div>

  <!-- COMMISSION DASHBOARD -->
  <div class="card">
    <h2>Commission Dashboard</h2>

    <div class="stats-row">
      <div class="stat-box">
        <h3>Total Earned</h3>
        <p id="commissionTotal">$0</p>
      </div>

      <div class="stat-box">
        <h3>Last Payout</h3>
        <p id="lastPayout">$0</p>
      </div>

      <div class="stat-box">
        <h3>Orders This Month</h3>
        <p id="ordersThisMonth">0</p>
      </div>
    </div>
  </div>

  <!-- QR CODE -->
  <div class="card qr-box">
    <h2>Your Legacy Lounge QR Code</h2>
    <p>Display this QR code near your installation for easy customer access.</p>
    <img id="qrImage" src="">
  </div>

  <!-- CONTACT BUTTON -->
  <a href="mailto:info@dopeleeprezzedbysllc.com" class="contact-btn">
    Message Dopelee Partner Support
  </a>

</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbyNg4ikJ28LTUpy1AVdncGCGw1M6ETqxD9dt0_ARCJMw9vPuC2i0VKqzzGoKtRIJErE/exec";

/* READ ?partner= FROM URL */
const urlParams = new URLSearchParams(window.location.search);
const partnerId = urlParams.get("partner");

if (!partnerId) {
  document.body.innerHTML = "<h2 style='color:white;text-align:center;margin-top:50px;'>Partner ID Missing</h2>";
}

/* FETCH PARTNER DATA */
fetch(`${API_URL}?partner=${partnerId}`)
  .then(res => res.json())
  .then(data => {
    console.log("Partner Data Loaded:", data);

    document.getElementById("businessName").innerText = data.Business_Name || "";
    document.getElementById("contactPerson").innerText = data.Contact_Person || "";
    document.getElementById("contactEmail").innerText = data.Contact_Email || "";
    document.getElementById("status").innerText = data.Status || "Pending";

    document.getElementById("installScheduled").innerText = data.Setup_Scheduled_Date || "Not Scheduled";
    document.getElementById("installCompleted").innerText = data.Setup_Completed_Date || "Not Completed";
    document.getElementById("activated").innerText = data.Date_Activated || "Not Activated";

    document.getElementById("commissionTotal").innerText = "$" + (data.Commission_Earned_Total || 0);
    document.getElementById("lastPayout").innerText = "$" + (data.Last_Commission_Amount || 0);
    document.getElementById("ordersThisMonth").innerText = data.Orders_Count_This_Month || 0;

    document.getElementById("qrImage").src = data.QR_Code_URL || "";
  })
  .catch(err => {
    console.error(err);
    document.body.innerHTML = "<h2 style='color:white;text-align:center;margin-top:50px;'>Error loading partner data</h2>";
  });
</script>

</body>
</html>
